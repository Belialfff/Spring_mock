import xml.etree.ElementTree as ET

tree = ET.parse('xxx.jmx')
root = tree.getroot()

for transaction_controller in tree.findall('.//TransactionController'):
    controller_name = transaction_controller.get('testname')
    frontend_samples = []

    for sampler in transaction_controller.findall('.//HTTPSamplerProxy'):
        path = sampler.find('./stringProp[@name="HTTPSampler.path"]').text
        if 'frontend' in controller_name and (path.endswith('.json') or path.endswith('.jpg') or path.endswith('.js')):
            frontend_samples.append(sampler)

    if frontend_samples:
        new_controller_name = controller_name + ' frontend'
        new_transaction_controller = ET.Element('TransactionController', {'guiclass': 'TransactionControllerGui',
                                                                          'testclass': 'TransactionController',
                                                                          'testname': new_controller_name,
                                                                          'enabled': 'true'})
        transaction_controller.append(new_transaction_controller)

        elements = list(transaction_controller)
        transaction_controller.clear()

        for element in elements:
            if element.tag == 'HTTPSamplerProxy':
                path = element.find('./stringProp[@name="HTTPSampler.path"]').text
                if not (path.endswith('.json') or path.endswith('.jpg') or path.endswith('.js')):
                    transaction_controller.append(element)
            else:
                transaction_controller.append(element)

        for sampler in frontend_samples:
            new_transaction_controller.append(sampler)

tree.write('xxx_new.jmx', encoding='UTF-8', xml_declaration=True)
